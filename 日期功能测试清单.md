# 日期功能测试清单

## 测试前准备

1. 确保后端服务正在运行：`http://localhost:3001`
2. 确保前端服务正在运行：`http://localhost:5173`
3. 确保已登录系统

## 测试步骤

### 测试 1：首页日期显示

**页面**：`http://localhost:5173/` (首页)

**步骤**：
1. [ ] 登录系统
2. [ ] 查看"最近目标"表格
3. [ ] 检查"结束日期"列

**预期结果**：
- ✅ 日期显示格式正确（如：2024/1/21）
- ✅ 没有显示 "Invalid Date"
- ✅ 空日期显示为空白

**实际结果**：
```
记录测试结果：
```

---

### 测试 2：OKR管理页面日期显示

**页面**：`http://localhost:5173/okr`

**步骤**：
1. [ ] 访问 OKR 管理页面
2. [ ] 查看"目标列表"表格
3. [ ] 检查"开始日期"列
4. [ ] 检查"结束日期"列

**预期结果**：
- ✅ 开始日期显示格式正确
- ✅ 结束日期显示格式正确
- ✅ 没有显示 "Invalid Date"
- ✅ 空日期显示为空白

**实际结果**：
```
记录测试结果：
```

---

### 测试 3：编辑现有目标的日期

**页面**：`http://localhost:5173/okr`

**步骤**：
1. [ ] 在目标列表中选择一个已有目标
2. [ ] 点击"编辑"按钮
3. [ ] 检查模态框中的"开始日期"选择器
4. [ ] 检查模态框中的"结束日期"选择器
5. [ ] 确认日期是否正确显示在选择器中

**预期结果**：
- ✅ 开始日期选择器显示正确的日期
- ✅ 结束日期选择器显示正确的日期
- ✅ 日期选择器可以正常点击和操作
- ✅ 没有控制台错误

**实际结果**：
```
记录测试结果：
```

---

### 测试 4：修改目标日期

**页面**：`http://localhost:5173/okr`

**步骤**：
1. [ ] 点击某个目标的"编辑"按钮
2. [ ] 点击"开始日期"选择器
3. [ ] 选择一个新的开始日期
4. [ ] 点击"结束日期"选择器
5. [ ] 选择一个新的结束日期
6. [ ] 点击"确定"保存
7. [ ] 检查表格中的日期是否更新

**预期结果**：
- ✅ 日期选择器正常打开
- ✅ 可以选择新日期
- ✅ 保存成功提示
- ✅ 表格中日期更新为新值
- ✅ 刷新页面后日期仍然正确

**实际结果**：
```
记录测试结果：
```

---

### 测试 5：新建目标并设置日期

**页面**：`http://localhost:5173/okr`

**步骤**：
1. [ ] 点击"新建目标"按钮
2. [ ] 填写目标标题（必填）
3. [ ] 选择负责人（必填）
4. [ ] 点击"开始日期"选择器
5. [ ] 选择开始日期
6. [ ] 点击"结束日期"选择器
7. [ ] 选择结束日期
8. [ ] 点击"确定"保存
9. [ ] 检查新建的目标在表格中的日期显示

**预期结果**：
- ✅ 日期选择器正常工作
- ✅ 可以选择任意日期
- ✅ 保存成功
- ✅ 新目标的日期在表格中正确显示

**实际结果**：
```
记录测试结果：
```

---

### 测试 6：日期验证

**页面**：`http://localhost:5173/okr`

**步骤**：
1. [ ] 点击"新建目标"按钮
2. [ ] 填写目标标题
3. [ ] 选择负责人
4. [ ] 不选择日期，直接点击"确定"
5. [ ] 观察是否有验证提示

**预期结果**：
- ✅ 显示"请选择开始日期"的错误提示
- ✅ 显示"请选择结束日期"的错误提示
- ✅ 无法保存目标

**实际结果**：
```
记录测试结果：
```

---

### 测试 7：日期格式一致性

**页面**：`http://localhost:5173/okr` 和 `http://localhost:5173/`

**步骤**：
1. [ ] 在 OKR 管理页面查看日期格式
2. [ ] 在首页查看日期格式
3. [ ] 对比两个页面的日期格式是否一致

**预期结果**：
- ✅ 两个页面的日期格式一致
- ✅ 都使用本地化格式（如：2024/1/21）

**实际结果**：
```
记录测试结果：
```

---

### 测试 8：边界情况测试

**页面**：`http://localhost:5173/okr`

**步骤**：
1. [ ] 新建目标，选择今天的日期
2. [ ] 新建目标，选择过去的日期
3. [ ] 新建目标，选择未来很远的日期（如 2030 年）
4. [ ] 检查所有日期是否正确保存和显示

**预期结果**：
- ✅ 所有日期都能正确保存
- ✅ 所有日期都能正确显示
- ✅ 没有日期范围限制错误

**实际结果**：
```
记录测试结果：
```

---

### 测试 9：浏览器兼容性

**测试浏览器**：
- [ ] Chrome
- [ ] Firefox
- [ ] Safari
- [ ] Edge

**步骤**：
在每个浏览器中重复测试 1-5

**预期结果**：
- ✅ 所有浏览器中日期显示一致
- ✅ 所有浏览器中日期选择器正常工作

**实际结果**：
```
Chrome: 
Firefox: 
Safari: 
Edge: 
```

---

### 测试 10：控制台错误检查

**页面**：所有页面

**步骤**：
1. [ ] 打开浏览器开发者工具（F12）
2. [ ] 切换到 Console 标签
3. [ ] 执行上述所有测试
4. [ ] 观察是否有错误或警告

**预期结果**：
- ✅ 没有与日期相关的错误
- ✅ 没有 "Invalid Date" 相关的警告
- ✅ 没有 dayjs 相关的错误

**实际结果**：
```
记录控制台信息：
```

---

## 测试总结

### 通过的测试
```
列出通过的测试编号：
```

### 失败的测试
```
列出失败的测试编号和原因：
```

### 需要修复的问题
```
列出发现的问题：
1. 
2. 
3. 
```

### 测试结论
```
[ ] 所有测试通过，日期功能正常
[ ] 部分测试失败，需要修复
[ ] 大部分测试失败，需要重新检查代码
```

---

## 调试技巧

### 1. 查看日期原始值
在浏览器控制台执行：
```javascript
// 查看表格数据
console.log(okrStore.objectives);

// 查看某个目标的日期
console.log(okrStore.objectives[0].startDate);
console.log(okrStore.objectives[0].endDate);
```

### 2. 测试 dayjs 是否正常工作
在浏览器控制台执行：
```javascript
import('dayjs/esm').then(dayjs => {
  console.log('dayjs loaded:', dayjs);
  console.log('Current date:', dayjs.default().format('YYYY-MM-DD'));
});
```

### 3. 检查日期格式
在浏览器控制台执行：
```javascript
const testDate = '2024-01-21T00:00:00.000Z';
console.log('Valid:', !isNaN(new Date(testDate).getTime()));
console.log('Formatted:', new Date(testDate).toLocaleDateString());
```

### 4. 查看网络请求
1. 打开开发者工具的 Network 标签
2. 执行保存操作
3. 查看请求的 Payload
4. 确认日期格式是否正确（应为 ISO 8601 格式）

---

## 常见问题排查

### 问题 1：日期仍然显示 Invalid Date
**排查步骤**：
1. 检查后端返回的日期格式
2. 在控制台打印原始数据
3. 确认 customRender 函数是否正确

### 问题 2：编辑时日期选择器为空
**排查步骤**：
1. 检查是否正确导入 dayjs
2. 确认 handleEditObjective 函数中的日期转换
3. 检查控制台是否有错误

### 问题 3：保存后日期丢失
**排查步骤**：
1. 检查 handleSaveObjective 函数中的日期转换
2. 查看网络请求的 Payload
3. 检查后端是否正确保存日期

### 问题 4：日期格式不一致
**排查步骤**：
1. 检查所有 customRender 函数
2. 确认使用相同的格式化方法
3. 考虑使用统一的日期格式化函数

---

## 测试完成签名

**测试人员**：________________

**测试日期**：________________

**测试环境**：
- 操作系统：________________
- 浏览器：________________
- Node.js 版本：________________

**备注**：
```
其他需要说明的内容：
```
